<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>K-san</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    overscroll-behavior: contain;
    touch-action: none;
  }

  body {
    font-family: "Poppins", sans-serif;
    background: linear-gradient(135deg, #ffcce7, #d8b7ff);
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 15px;
    user-select: none;
  }

  .stack {
    position: relative;
    width: 90%;
    max-width: 380px;
    min-height: 260px;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .card {
    position: absolute;
    width: 100%;
    min-height: 240px;
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(8px);
    border-radius: 20px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    transition: all 0.6s ease;
    padding: 25px;
  }

  h2 {
    color: #444;
    font-size: 1.2rem;
    margin-bottom: 25px;
    line-height: 1.4;
  }

  button {
    font-size: 1rem;
    padding: 10px 25px;
    margin: 8px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .yes {
    background-color: #ffb6c1;
    color: white;
  }

  .yes:hover {
    background-color: #ffa7b2;
    transform: scale(1.05);
  }

  .no {
    background-color: #ffd6e0;
    color: #555;
    position: relative;
  }

  .no:hover {
    background-color: #ffc0cb;
    transform: scale(1.05);
  }

  .message {
    font-size: 1.05rem;
    color: #333;
    padding: 30px 25px;
    border: 2px solid rgba(255, 182, 193, 0.8);
    border-radius: 25px;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(10px);
    box-shadow: 0 10px 25px rgba(255, 182, 193, 0.4);
    line-height: 1.5;
    white-space: pre-line;
  }

  .typing {
    border-right: 2px solid #ffb6c1;
    animation: blink 0.8s infinite;
  }

  @keyframes blink {
    50% { border-color: transparent; }
  }

  @media (max-width: 480px) {
    h2 {
      font-size: 1rem;
    }
    button {
      font-size: 0.9rem;
      padding: 8px 20px;
    }
    .stack {
      width: 100%;
    }
    .card {
      padding: 20px;
      border-radius: 18px;
    }
  }
</style>
</head>
<body>
  <div class="stack" id="stack">
    <div class="card" id="card0">
      <h2>Are you okay now?</h2>
      <div>
        <button class="yes">Yes</button>
        <button class="no">No</button>
      </div>
    </div>
  </div>

<script>
const questions = [
  "Are you okay now?",
  "Do you think you did good enough?",
  "Do you think things will get better?",
  "Will you be a bit more selfish from now?"
];

let answers = [];
let count = 0;
const stack = document.getElementById("stack");

function createCard(index) {
  const newCard = document.createElement("div");
  newCard.classList.add("card");
  if (index === questions.length - 1) newCard.classList.add("last");
  newCard.style.transform = `translate(${index * 10}px, ${index * 10}px)`;
  newCard.innerHTML = `
    <h2>${questions[index]}</h2>
    <div>
      <button class="yes">Yes</button>
      <button class="no">No</button>
    </div>
  `;
  stack.appendChild(newCard);

  const yesBtn = newCard.querySelector(".yes");
  const noBtn = newCard.querySelector(".no");

  yesBtn.addEventListener("click", () => handleAnswer("Yes", index, newCard));
  noBtn.addEventListener("click", () => handleAnswer("No", index, newCard));
}

function handleAnswer(choice, index, card) {
  answers[index] = choice;

  if (index === questions.length - 1) {
    const noBtn = card.querySelector(".no");
    if (choice === "No") {
      // No button runs away randomly every time
      noBtn.style.position = "absolute";
      noBtn.style.transition = "all 0.4s ease";
      const randX = Math.random() * 200 - 100;
      const randY = Math.random() * 100 - 50;
      noBtn.style.transform = `translate(${randX}px, ${randY}px) rotate(${Math.random()*20 - 10}deg)`;
      return;
    } else {
      showFinalMessage();
    }
  } else {
    count++;
    createCard(count);
  }
}

function typeMessage(text, container) {
  let i = 0;
  const typing = document.createElement("span");
  typing.classList.add("typing");
  container.appendChild(typing);

  const interval = setInterval(() => {
    typing.textContent = text.slice(0, i);
    i++;
    if (i > text.length) {
      clearInterval(interval);
      typing.classList.remove("typing");
    }
  }, 65); // slower typing speed
}

function showFinalMessage() {
  const [a1, a2, a3, a4] = answers;
  let message = "";

  if (a1 === "Yes" && a2 === "No" && a3 === "No") {
    message = `K-san already told you — you did good enough.\nDon’t have second thoughts, it’s not your fault.\nThings will get better, just put in a little trust :3\n\nbtw im not allowing you to press no for that question no uh, its okiii hehe`;
  } else if (a1 === "No" && a2 === "No" && a3 === "Yes") {
    message = `Oii!! even if you don’t feel okay yet,\nit’ll get better soon :3 you did what you could, don’t feel guilty.\nHopefully things will get easier\n\nbtw im not allowing you to press no for that question no uh, its okiii hehe`;
  } else if (a1 === "Yes" && a2 === "Yes" && a3 === "Yes") {
    message = `That’s how I want Rae-san to be :3\nYesss, put in that trust and keep moving forward!\nKeep it light, keep it soft\n\nbtw im not allowing you to press no for that question no uh, its okiii hehe`;
  } else {
    message = `You will be okay... things will be okay.\nDon’t lose hope, things are just the way they’re meant to be.\nBe gentle with yourself, K-san\n\nbtw im not allowing you to press no for that question no uh, its okiii hehe`;
  }

  stack.innerHTML = `<div class="card message" id="finalMsg"></div>`;
  const msgDiv = document.getElementById("finalMsg");
  typeMessage(message, msgDiv);
  document.body.style.background = "linear-gradient(135deg, #ffd6e0, #f9d1ff)";
}

const firstCard = document.querySelector("#card0");
firstCard.querySelector(".yes").addEventListener("click", () => handleAnswer("Yes", 0, firstCard));
firstCard.querySelector(".no").addEventListener("click", () => handleAnswer("No", 0, firstCard));
</script>
</body>
</html>
