<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>K-san</title>
<style>
  *{box-sizing:border-box;}
  body{
    margin:0;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:linear-gradient(135deg,#ffcce7,#e8b8ff);
    font-family:"Poppins",sans-serif;
    overflow:hidden;
  }

  .stack{
    position:relative;
    width:90%;
    max-width:380px;
    height:320px;
  }

  .card{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(255,255,255,0.8);
    backdrop-filter:blur(8px);
    border-radius:18px;
    box-shadow:0 8px 25px rgba(0,0,0,0.15);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    opacity:0;
    transform:translateY(30px) scale(0.97);
    transition:all 0.6s cubic-bezier(.25,.9,.25,1);
    padding:24px;
  }

  .card.show{
    opacity:1;
    transform:translateY(0) scale(1);
  }

  h2{
    margin-bottom:20px;
    color:#444;
    font-size:1.1rem;
  }

  .buttons{
    display:flex;
    gap:16px;
  }

  button{
    border:none;
    border-radius:10px;
    padding:10px 22px;
    font-size:1rem;
    cursor:pointer;
    transition:transform .15s;
  }

  .yes{
    background:#ffb6c1;
    color:#fff;
  }
  .yes:active{transform:scale(.96);}

  .no{
    background:#ffdce5;
    color:#333;
    position:relative;
  }
  .no:active{transform:scale(.96);}

  .card.message{
    background:rgba(255,255,255,0.85);
    padding:28px;
    font-size:1rem;
    line-height:1.5;
    white-space:pre-line;
    border:2px solid #ffcce7;
    border-radius:20px;
  }

  .typing{
    border-right:2px solid #ffb6c1;
    animation:blink 1s infinite;
  }
  @keyframes blink{50%{border-color:transparent;}}

  @media(max-width:480px){
    .stack{height:280px;}
    h2{font-size:1rem;}
    button{font-size:.9rem;padding:8px 16px;}
  }
</style>
</head>
<body>
  <div class="stack" id="stack"></div>

<script>
const questions = [
  "Are you okay now?",
  "Do you think you did good enough?",
  "Do you think things will get better?",
  "Will you be a bit more selfish from now?"
];

const stack = document.getElementById("stack");
let answers = [];
let current = 0;

function createCard(index){
  const card = document.createElement("div");
  card.className = "card";
  const offset = index * 10; // stacked offset
  card.style.transform = `translate(${offset}px, ${offset+30}px) scale(0.97)`;
  card.style.zIndex = 10 + index;
  card.innerHTML = `
    <h2>${questions[index]}</h2>
    <div class="buttons">
      <button class="yes">Yes</button>
      <button class="no">No</button>
    </div>
  `;
  stack.appendChild(card);

  requestAnimationFrame(()=>{
    card.classList.add("show");
    card.style.transform = `translate(${offset}px, ${offset}px) scale(1)`;
  });

  const yesBtn = card.querySelector(".yes");
  const noBtn = card.querySelector(".no");

  yesBtn.onclick = () => handleAnswer("yes");
  if(index === questions.length-1){
    // last question "No" moves away
    const moveHandler = () => moveNo(noBtn);
    noBtn.addEventListener("mouseenter", moveHandler);
    noBtn.addEventListener("click", moveHandler);
    noBtn.addEventListener("touchstart", moveHandler);
  } else {
    noBtn.onclick = () => handleAnswer("no");
  }
}

function moveNo(btn){
  btn.style.pointerEvents = "none";
  setTimeout(()=> btn.style.pointerEvents = "auto", 400);
  let rx, ry;
  do {
    rx = Math.random()*260 - 130;
    ry = Math.random()*140 - 70;
  } while(Math.abs(rx)<60 && Math.abs(ry)<40);
  btn.style.transform = `translate(${rx}px,${ry}px)`;
}

function handleAnswer(ans){
  answers.push(ans);
  current++;
  if(current < questions.length){
    createCard(current);
  } else {
    showFinalMessage();
  }
}

function typeWriter(text, element, speed = 80){
  let i=0;
  const span = document.createElement("span");
  span.className = "typing";
  element.appendChild(span);
  element.style.opacity = 1;
  const interval = setInterval(()=>{
    span.textContent = text.slice(0,i);
    i++;
    if(i>text.length) clearInterval(interval);
  }, speed);
}

function showFinalMessage(){
  const [a1,a2,a3] = answers;
  let msg = "";
  if(a1==="yes" && a2==="no" && a3==="no"){
    msg=`K-san already told you — you did good enough.\nDon’t have second thoughts, it’s not your fault.\nThings will get better, just put in trust :3\n\nbtw im not allowing you to press no for that question no uh, its okiii hehe`;
  } else {
    msg=`You will be okay... things will be okay.\nDon’t lose hope.\nBe gentle with yourself, K-san.\n\nbtw im not allowing you to press no for that question no uh, its okiii hehe`;
  }
  stack.innerHTML = "";
  const msgCard = document.createElement("div");
  msgCard.className = "card message";
  stack.appendChild(msgCard);
  typeWriter(msg, msgCard);
}

// Start first question
createCard(current);
</script>
</body>
</html>
